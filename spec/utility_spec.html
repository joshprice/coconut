<html>

<head>
  <title>Utility Spec</title>
  <script src="../lib/jquery-1.3.2.js"></script>
  <script src="screw.unit.dependencies.js"></script>
  <script src="test_extensions.js"></script>
  <script src="../src/jquery.coconut.js"></script>
</head>

<body>
  
<script type="text/javascript">
Screw.Unit(function() {

  describe("Object Equality", function() {
    it("should have same property and value", function() {
      expect($.objectEqual({ name: "luning" }, { name: "luning" })).to(be_true);
    });       
    
    it("should have same amount of properties", function() {
      expect($.objectEqual({ name: "luning", age: "20" }, { name: "luning" })).to(be_false);
      expect($.objectEqual({ name: "luning" }, { name: "luning", age: "20" })).to(be_false);
    });     
    
    it("should be equal if only have different property order", function() {
      expect($.objectEqual({ name: "luning", age: "20" }, { age: "20", name: "luning" })).to(be_true);
    });     
    
    it("should compare objects recursively", function() {
      expect($.objectEqual({ dob: {year: "1990"} }, { dob: {year: "1990"} })).to(be_true);
      expect($.objectEqual({ dob: {year: "1990"} }, { dob: {year: "2009"} })).to(be_false); 
      expect($.objectEqual({ dob: {year: "1990"} }, { })).to(be_false); 
      expect($.objectEqual({ person: { dob: { year: "1990"} } }, { person: { dob: { year: "1990" } } })).to(be_true);
      expect($.objectEqual({ person: { dob: { year: "1990"} } }, { person: { dob: { month: "Jan" } } })).to(be_false);
    });   
    
    it("should ignore property if it's value is undefined", function() {
      expect($.objectEqual({ dob: undefined }, { })).to(be_true);
      expect($.objectEqual({ }, { dob: undefined })).to(be_true);
    });   
    
    it("should not ignore property if it's value is null", function() {
      expect($.objectEqual({ dob: null }, { })).to(be_false);
      expect($.objectEqual({  }, { dob: null })).to(be_false);
    });   
    
    it("should ignore property if it's an empty array", function() {
      expect($.objectEqual({ emails: [] }, { })).to(be_true);
      expect($.objectEqual({  }, { emails: [] })).to(be_true);
    });   

    it("should ignore property if it's an empty object", function() {
      expect($.objectEqual({ dob: {} }, { })).to(be_true);
      expect($.objectEqual({ }, { dob: {} })).to(be_true);
    }); 
    
    it("array property should contain same value and in same order", function() {
      expect($.objectEqual({ numbers: [1, 2] }, { numbers: [1, 2]})).to(be_true);
      expect($.objectEqual({ numbers: [1, 2] }, { numbers: [2, 1]})).to(be_false);
      expect($.objectEqual({ numbers: [1, 2] }, { numbers: [1]})).to(be_false);
    }); 
    
    it("should compare directly against two arrays", function() {
      expect($.objectEqual([1, 2], [1, 2])).to(be_true);
      expect($.objectEqual([1, 2], [2, 1])).to(be_false);
      expect($.objectEqual([1, 2], [1])).to(be_false);
    }); 
    
    it("should compare arrays recursively", function() {
      expect($.objectEqual([1, [1, 2]], [1, [1, 2]])).to(be_true);
      expect($.objectEqual([1, [1, 2]], [1, [2, 1]])).to(be_false);
      expect($.objectEqual([1, [2]], [[2], 1])).to(be_false);
    }); 
    
    it("should compare arrays mixed with objects recursively", function() {
      expect($.objectEqual([1, {name:"lu"}], [1, {name:"lu"}])).to(be_true);
      expect($.objectEqual([1, {name:"lu"}], [1, {name:"smith"}])).to(be_false);
    }); 
    
    it("should compare primative types", function() {
      expect($.objectEqual(1, 1)).to(be_true);
      expect($.objectEqual("1", "1")).to(be_true);
      expect($.objectEqual("", "")).to(be_true);
      
      expect($.objectEqual("", "1")).to(be_false);
      expect($.objectEqual("1", "")).to(be_false);
      expect($.objectEqual("0", 0)).to(be_false);
      expect($.objectEqual(1, "1")).to(be_false);
    }); 
    
    it("should compare primative type with undefined or null", function() {
      expect($.objectEqual(0, undefined)).to(be_false);
      expect($.objectEqual(0, null)).to(be_false);
      expect($.objectEqual("", undefined)).to(be_false);
      expect($.objectEqual("", null)).to(be_false);

      expect($.objectEqual(undefined, 0)).to(be_false);
      expect($.objectEqual(null, 0)).to(be_false);
      expect($.objectEqual(undefined, "")).to(be_false);
      expect($.objectEqual(null, "")).to(be_false);
    }); 
  });

  describe("A Contains B", function() {
    it("requires B is a subset of A if they are objects", function() {
      expect($.objectContain({ name: "luning" }, { name: "luning" })).to(be_true);
      expect($.objectContain({ name: "luning" }, { name: "smith"  })).to(be_false);
      expect($.objectContain({ name: "luning" }, { })).to(be_true);
      expect($.objectContain({ dob: {day: "01", month: "Feb"} }, { dob: {day: "01"} })).to(be_true);
      expect($.objectContain({ dob: {day: "01", month: "Feb"} }, { dob: {month: "Jan"} })).to(be_false);
      expect($.objectContain({ }, { name: "luning" })).to(be_false);
      expect($.objectContain({ }, { emails: ["1@my.com"] })).to(be_false);
    });

    it("should ignore property if it is undefined, an empty object or an empty array", function() {
      expect($.objectContain({ }, { name: undefined })).to(be_true);
      expect($.objectContain({ }, { contact: {} })).to(be_true);
      expect($.objectContain({ }, { emails: [] })).to(be_true);
    });
    
    it("should not ignore property if it is null", function() {
      expect($.objectContain({ }, { name: null })).to(be_false);
    });  
    
    it("should do equality check for primative types", function() {
      expect($.objectContain("", "")).to(be_true);
      expect($.objectContain("1", "1")).to(be_true);
      expect($.objectContain(1, 1)).to(be_true);
      
      expect($.objectContain("q", "")).to(be_false);
      expect($.objectContain(1, 2)).to(be_false);
      expect($.objectContain(1, "1")).to(be_false);
      expect($.objectContain("1", 1)).to(be_false);
    });
            
    it("should check primative type with undefined or null", function() {
      expect($.objectContain(0, undefined)).to(be_false);
      expect($.objectContain(0, null)).to(be_false);
      expect($.objectContain("", undefined)).to(be_false);
      expect($.objectContain("", null)).to(be_false);

      expect($.objectContain(undefined, 0)).to(be_false);
      expect($.objectContain(null, 0)).to(be_false);
      expect($.objectContain(undefined, "")).to(be_false);
      expect($.objectContain(null, "")).to(be_false);
    }); 

    it("requires A start with B if they are arrays", function() {
      expect($.objectContain([1, 2, 3], [1, 2])).to(be_true);
      expect($.objectContain([1, 2, 3], [2, 3])).to(be_false);
      expect($.objectContain([1, 2], [1, 2, 3])).to(be_false);
    });       
  });
});
</script>
</body>
</html>